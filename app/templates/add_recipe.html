<!-- add_recipe.html -->
{% extends "base.html" %}

{% block content %}

<h1>Neues Rezept</h1>
<form action="" method="post" novalidate>
    {{ form.hidden_tag() }}
    <p>
        {{ form.recipename.label }}<br>
        {{ form.recipename }}<br>
        {% for error in form.recipename.errors %}
        <span style="color: red;">[{{ error }}]</span>
        {% endfor %}
    </p>
    <p>
        {{ form.ingredient1.label }}<br>
        {{ form.ingredient1 }}<br>
        {% for error in form.ingredient1.errors %}
        <span style="color: red;">[{{ error }}]</span>
        {% endfor %}
    </p>
    <p>
        {{ form.ingredient1_amount.label }}<br>
        {{ form.ingredient1_amount }}<br>
        {% for error in form.ingredient1_amount.errors %}
        <span style="color: red;">[{{ error }}]</span>
        {% endfor %}
    </p>
    <p>
        {{ form.ingredient1_unit.label }}<br>
        {{ form.ingredient1_unit }}<br>
        {% for error in form.ingredient1_unit.errors %}
        <span style="color: red;">[{{ error }}]</span>
        {% endfor %}
    </p>
    <h2>Arbeitsschritte</h2>
    <div id="tasks-container">
        {% for task_form in form.tasks %}
            <p>
                {{ task_form.task.label }}<br>
                {{ task_form.task }}<br>
                {% for error in task_form.task.errors %}
                <span style="color: red;">[{{ error }}]</span>
                {% endfor %}
            </p>
        {% endfor %}
    </div>
    <button type="button" id="add-task">Add Task</button>
    <p>{{ form.submit() }}</p>
</form>

<script>
    document.getElementById('add-task').addEventListener('click', function() {
        var container = document.getElementById('tasks-container');
        var index = container.children.length;
        var taskHtml = `
            <p>
                <label for="tasks-${index}-task">Arbeitsschritt ${index + 1}</label><br>
                <input type="text" name="tasks-${index}-task" id="tasks-${index}-task" required><br>
            </p>
        `;
        container.insertAdjacentHTML('beforeend', taskHtml);
    });
    </script>

{% endblock %}
